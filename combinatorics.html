

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Combinatorial Generalizaton and Interactivity &mdash; Leabra Tensorflow 0+untagged.63.ga5c4bdc documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Visualization" href="visualization.html" />
    <link rel="prev" title="Release Schedule" href="release_schedule.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Leabra Tensorflow
          

          
          </a>

          
            
            
              <div class="version">
                0+untagged.63.ga5c4bdc
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="release_schedule.html">Release Schedule</a></li>
</ul>
<p class="caption"><span class="caption-text">Tasks</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Combinatorial Generalizaton and Interactivity</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="#desiderata">Desiderata</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="#default-experimental-configuration">Default Experimental Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#combigen-task-functions">Combigen Task Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dataset-generation">Dataset Generation</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Scripts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utility Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="tfutils.html">Tensorflow Utility Functions</a></li>
</ul>
<p class="caption"><span class="caption-text">Notebooks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notebooks/0.0-Notebook-Template.html">0.0 Leabra-tf Notebook Template</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/0.1-Designing-the-Combigen-Task.html">0.1 Implementing the Combinatorial Generalization Task</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/0.1.1-Combigen-All-True-Bug-Fix.html">0.1.1 Combigen All-True Bug Fix</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/0.1.2-Combigen-Stacks.html">0.1.2 Combigen Stacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/0.1.3-Specifying-the-Number-of-Lines.html">0.1.3 Specifying the Number of Lines</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/0.1.4-Selectable-Line-Statistics.html">0.1.4 Selectable Line Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/0.2-Running-a-Basic-Model-on-Combigen.html">0.2 Running a Basic Model on Combigen</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/0.2.1-Iterating-the-BP-Model-on-GPUs.html">0.2.1 Iterating the BP Model on GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/0.3-BP-Model-in-Tensorflow.html">0.3 BP Model in Tensorflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/0.3.1-Comparing-Accuracy-Metrics.html">0.3.1 Comparing Accuracy Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/0.4-Exploring-Different-Learning-Rates.html">0.4 Exploring Different Learning Rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/0.4.1-Exploring-Different-Optimizers.html">0.4.1 Exploring Different Optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/0.5-Adam-Optimizer-Learning-Rate-Tuning-and-Dropout.html">0.5 Adam Optimizer Learning Rate Tuning and Dropout</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/0.5.1-Adam-With-Non-Uniform-Task-Statistics.html">0.5.1 Adam with Non-Uniform Task Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/0.6-Hebbian-Learning.html">0.6 Hebbian Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/0.7-Replicating-Results-with-the-Updated-Task.html">0.7 Replicating Results with the Updated Task</a></li>
</ul>
<p class="caption"><span class="caption-text">Project Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://apra93.github.io/leabra-tf/">Home</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/apra93/leabra-tf/">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://travis-ci.org/apra93/leabra-tf">Travis CI</a></li>
<li class="toctree-l1"><a class="reference external" href="https://codecov.io/gh/apra93/leabra-tf">Codecov</a></li>
<li class="toctree-l1"><a class="reference external" href="https://app.codacy.com/project/apra93/leabra-tf/dashboard">Codacy</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Leabra Tensorflow</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Combinatorial Generalizaton and Interactivity</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/combinatorics.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="combinatorial-generalizaton-and-interactivity">
<h1>Combinatorial Generalizaton and Interactivity<a class="headerlink" href="#combinatorial-generalizaton-and-interactivity" title="Permalink to this headline">¶</a></h1>
<p>The task described here is meant to be an implementation of O’Reily’s task in
<a class="reference external" href="https://www.mitpressjournals.org/doi/10.1162/08997660152002834">Generalization in Interactive Networks: The Benefits of Inhibitory Competition and Hebbian Learning</a>.
The majority of the text below is taken directly from section <strong>2</strong> of the
paper.</p>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Combinatorial structure is implemented by having <em>four</em> different input-output
slots.</p></li>
<li><p>The output mapping for a given slot depends only on the corresponding input
pattern for that slot (see <a class="reference external" href="https://scholar.colorado.edu/csci_techreports/647/">Brousse, 1993</a>; <a class="reference external" href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.51.2295">Noelle &amp; Cottrell, 1996</a>,
for similar tasks).</p></li>
<li><p>Each slow has a vocabulary of input-output mappings.</p></li>
<li><p>Input vocabulary consists of all 45 combinations of 5 horizontal and 5
vertical bars in a 5x5 grid.</p></li>
<li><p>Output mapping is a localist identification of the two input bars (similar to
bar tasks used by <a class="reference external" href="https://link.springer.com/article/10.1007%2FBF02331346">Foldiak, 1990</a>; <a class="reference external" href="https://www.mitpressjournals.org/doi/10.1162/neco.1995.7.1.51">Saund, 1995</a>; <a class="reference external" href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.53.6050">Zemel, 1993</a>;
<a class="reference external" href="http://www.gatsby.ucl.ac.uk/~dayan/papers/cdz95.pdf">Dayan &amp; Zemel, 1995</a>).</p></li>
<li><p>Total number of distinct input patterns is approximately 4.1 million.</p></li>
<li><p>Models are intended only to train on 100 randomly constructed examples, and
then test on an arbitraily large testing set (500 in the paper).</p></li>
<li><p>Error criterion is scored such that each output unit has to be on the right
side of 0.5 according to the correct target pattern.</p></li>
</ul>
</div>
<div class="section" id="desiderata">
<h2>Desiderata<a class="headerlink" href="#desiderata" title="Permalink to this headline">¶</a></h2>
<p>The paper described the task as having several desiderata.</p>
<ul class="simple">
<li><p>It has a simple combinatorial structure that allows for novel inputs to be
composed from a small vocabulary of features.</p></li>
<li><p>There is some interesting substructure to the vocabulary mapping at each slot.</p></li>
<li><p>The structure of the task should be apparent in the weight patterns of the
models.</p></li>
</ul>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://scholar.colorado.edu/csci_techreports/647/">Brousse, O. (1993). Generativity and systematicity in neural network combinatorial learning</a></p></li>
<li><p><a class="reference external" href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.51.2295">Noelle, D. C., &amp; Cottrell, G. W. (1996). In search of articulated attractors</a></p></li>
<li><p><a class="reference external" href="https://link.springer.com/article/10.1007%2FBF02331346">F¨oldi´ak, P. (1990). Forming sparse representations by local anti-Hebbian learning</a></p></li>
<li><p><a class="reference external" href="https://www.mitpressjournals.org/doi/10.1162/neco.1995.7.1.51">Saund, E. (1995). A multiple cause mixture model for unsupervised learning</a></p></li>
<li><p><a class="reference external" href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.53.6050">Zemel, R. S. (1993). A minimum description length framework for unsupervised learning</a></p></li>
<li><p><a class="reference external" href="http://www.gatsby.ucl.ac.uk/~dayan/papers/cdz95.pdf">Dayan, P., &amp; Zemel, R. S. (1995). Competition and multiple cause models</a></p></li>
</ul>
<!-- Markdown References --></div>
<div class="section" id="default-experimental-configuration">
<h2>Default Experimental Configuration<a class="headerlink" href="#default-experimental-configuration" title="Permalink to this headline">¶</a></h2>
<p>Below is the default experimental conditions used for the task. Variables
pertaining to the task itself are likely pulled straight from the paper.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;File to store the default experimental configuration.&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">types</span> <span class="kn">import</span> <span class="n">ModuleType</span>
<span class="kn">from</span> <span class="nn">pstar</span> <span class="kn">import</span> <span class="n">pdict</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># Combigen Task Variables</span>

<span class="c1"># Number of slots in a training set</span>
<span class="n">slots</span> <span class="o">=</span> <span class="mi">4</span>
<span class="c1"># Size of each axis in the input array</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">5</span>
<span class="c1"># Number of axes to use per slot</span>
<span class="n">dims</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1"># Number of lines per slot </span>
<span class="n">n_lines</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1"># Line frequency statistics</span>
<span class="n">line_stats</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>

<span class="c1"># Data Parameters</span>

<span class="c1"># Number of epochs to train for</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="mi">500</span>
<span class="c1"># Number of samples in the training set</span>
<span class="n">n_train</span> <span class="o">=</span> <span class="mi">100</span>
<span class="c1"># Number of samples in the validation set</span>
<span class="n">n_val</span> <span class="o">=</span> <span class="mi">50</span>
<span class="c1"># Number of samples in the testing set</span>
<span class="n">n_test</span> <span class="o">=</span> <span class="mi">500</span>
<span class="c1"># General variable that is meant to change based on the context</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="n">n_train</span>

<span class="c1"># Network parameters</span>

<span class="c1"># Learning rate</span>
<span class="n">lr</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1"># Batch size</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c1"># Number of parameters in the inputs</span>
<span class="n">n_inputs</span> <span class="o">=</span> <span class="n">slots</span> <span class="o">*</span> <span class="n">size</span> <span class="o">**</span> <span class="n">dims</span>
<span class="c1"># Number of hidden units</span>
<span class="n">n_hidden_1</span> <span class="o">=</span> <span class="mi">100</span>
<span class="c1"># Number of parameters in the labels</span>
<span class="n">n_outputs</span> <span class="o">=</span> <span class="n">slots</span> <span class="o">*</span> <span class="n">size</span> <span class="o">*</span> <span class="n">dims</span>

<span class="c1"># Training Parameters</span>

<span class="c1"># Number of times to print an update</span>
<span class="n">n_updates</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1"># Which device to train on</span>
<span class="n">tf_device</span> <span class="o">=</span> <span class="s1">&#39;/cpu:0&#39;</span>
<span class="c1"># Number of models to train with</span>
<span class="n">n_models</span> <span class="o">=</span> <span class="mi">10</span>
<span class="c1"># Recompute the model accuracy after this many epochs</span>
<span class="n">n_epochs_acc</span> <span class="o">=</span> <span class="mi">25</span>

<span class="c1"># Meta data variables</span>
<span class="c1"># Config name</span>
<span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span>
<span class="c1"># This is a configuration dict</span>
<span class="n">_config</span> <span class="o">=</span> <span class="bp">True</span>

<span class="k">def</span> <span class="nf">default_config</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function that turns all the values defined above into a dictionary.</span>

<span class="sd">    Grabs all the values in the ``globals`` dictionary and adds them to the</span>
<span class="sd">    returned dictionary if it is a relevant variable.</span>

<span class="sd">    The function also accepts keyword arguments that will be added to the config</span>
<span class="sd">    at the end, overwriting the existing value, or adding the key/value pair.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    default_config : pdict</span>
<span class="sd">    	Default configuration as defined by in the default_configuration.py file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Configuration in a dictionary format</span>
    <span class="n">locals_dict</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()</span>
    <span class="c1"># Empty dict we will fill</span>
    <span class="n">_dict</span> <span class="o">=</span> <span class="n">pdict</span><span class="p">()</span>

    <span class="c1"># Remove all the non configuration </span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">locals_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Skip if the key is a dunder key</span>
        <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">key</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="c1"># Skip if the value is a module</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">ModuleType</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="c1"># Skip if the value is a callable (presumably a function)</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="c1"># Skip if the value is the logger</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="n">logger</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Passed all skips, add to the dict</span>
        <span class="n">_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>

    <span class="c1"># Add any kwargs to the dictionary, overwriting any conflicting values</span>
    <span class="n">_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_dict</span>
</pre></div>
</div>
</div>
<div class="section" id="combigen-task-functions">
<h2>Combigen Task Functions<a class="headerlink" href="#combigen-task-functions" title="Permalink to this headline">¶</a></h2>
<p>These are the lower level task generation functions used to put together the
arrays used for inputs and labels.</p>
<dl class="function">
<dt id="leabratf.tasks.combinatorics.combigen.generate_labels">
<code class="descclassname">leabratf.tasks.combinatorics.combigen.</code><code class="descname">generate_labels</code><span class="sig-paren">(</span><em>n_samples=1</em>, <em>slots=4</em>, <em>size=5</em>, <em>dims=2</em>, <em>n_lines=2</em>, <em>line_stats=None</em><span class="sig-paren">)</span><a class="headerlink" href="#leabratf.tasks.combinatorics.combigen.generate_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array of labels to construct the data from.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of samples to return.</p></li>
<li><p><strong>slots</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of slots per sample.</p></li>
<li><p><strong>size</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of the nxn matrix to use for the task.</p></li>
<li><p><strong>dims</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of dimensions for the task.</p></li>
<li><p><strong>n_lines</strong> (<em>int</em><em>, </em><em>optional</em>) – Total number of lines to have per sample.</p></li>
<li><p><strong>line_stats</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Statistics for sampling from the <code class="docutils literal notranslate"><span class="pre">size</span> <span class="pre">x</span> <span class="pre">dims</span></code> elements.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>labels</strong> – The resulting task labels.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray of shape <code class="docutils literal notranslate"><span class="pre">(n_samples,</span> <span class="pre">stack,</span> <span class="pre">size,</span> <span class="pre">dims)</span></code></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">dims</span></code> does not match the number of lines provided (assuming more
    than one number was provided for it)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="leabratf.tasks.combinatorics.combigen.inverse_transform">
<code class="descclassname">leabratf.tasks.combinatorics.combigen.</code><code class="descname">inverse_transform</code><span class="sig-paren">(</span><em>Y</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#leabratf.tasks.combinatorics.combigen.inverse_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for first pass implementation that accounts for multiple
samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Y</strong> (<em>array-like</em>) – Array of samples</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>X</strong> – Array of samples transformed from <code class="docutils literal notranslate"><span class="pre">Y</span></code> to <code class="docutils literal notranslate"><span class="pre">X</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="leabratf.tasks.combinatorics.combigen.inverse_transform_single_sample">
<code class="descclassname">leabratf.tasks.combinatorics.combigen.</code><code class="descname">inverse_transform_single_sample</code><span class="sig-paren">(</span><em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#leabratf.tasks.combinatorics.combigen.inverse_transform_single_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Turns the inputted nxn array into the nx2 array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>y</strong> (<em>array-like</em><em> (</em><em>nx2</em><em>)</em>) – The the label we are transforming.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>X</strong> – The <code class="docutils literal notranslate"><span class="pre">X</span></code> that would have generated the inputted <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array (nxn)</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="dataset-generation">
<h2>Dataset Generation<a class="headerlink" href="#dataset-generation" title="Permalink to this headline">¶</a></h2>
<p>Below are the functions used to actually generate the datasets used by the
models.</p>
<dl class="function">
<dt id="leabratf.tasks.combinatorics.make_datasets.generate_combigen_x_y_dataset">
<code class="descclassname">leabratf.tasks.combinatorics.make_datasets.</code><code class="descname">generate_combigen_x_y_dataset</code><span class="sig-paren">(</span><em>n_samples=100</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#leabratf.tasks.combinatorics.make_datasets.generate_combigen_x_y_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to generate X and y pairs for the combigen task.</p>
<p>Convenience function that runs <code class="docutils literal notranslate"><span class="pre">cg.generate_labels</span></code> followed by
<code class="docutils literal notranslate"><span class="pre">cg.inverse_transform</span></code> to creat the <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> pairs for the data.
The only change is that now the default number of samples is defined as
<code class="docutils literal notranslate"><span class="pre">n_train</span></code> from <code class="docutils literal notranslate"><span class="pre">default_configuration.py</span></code>.</p>
<p>See documentation for <code class="docutils literal notranslate"><span class="pre">cg.generate_labels</span></code> for all passable arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of samples to produce for X and Y.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em>) – The <code class="docutils literal notranslate"><span class="pre">X</span></code> that would have generated the inputted <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p></li>
<li><p><strong>y</strong> (<em>np.array</em>) – Labels for the generated <code class="docutils literal notranslate"><span class="pre">X</span></code> array.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="leabratf.tasks.combinatorics.make_datasets.generate_combigen_datasets">
<code class="descclassname">leabratf.tasks.combinatorics.make_datasets.</code><code class="descname">generate_combigen_datasets</code><span class="sig-paren">(</span><em>n_samples_train=100, n_lines_train=2, line_stats_train=[[1, 1, 1, 1, 1], [1, 1, 1, 1, 1]], n_samples_val=50, n_lines_val=2, line_stats_val=[[1, 1, 1, 1, 1], [1, 1, 1, 1, 1]], n_samples_test=500, n_lines_test=2, line_stats_test=[[1, 1, 1, 1, 1], [1, 1, 1, 1, 1]], *args, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#leabratf.tasks.combinatorics.make_datasets.generate_combigen_datasets" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the training, validation, and testing set data.</p>
<p>Higher level wrapper that organizes the dataset into the expected groups of
training, validation, and testing sets. Default values are defined in
<code class="docutils literal notranslate"><span class="pre">default_configuration.py</span></code>.</p>
<p>Parameters that should not be varied between the three datasets (slots,
size, etc.) are included as star args and kwargs, while the rest that can
be varied are given their own variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples_train</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of samples to return in the training data.</p></li>
<li><p><strong>n_lines_train</strong> (<em>int</em><em>, </em><em>optional</em>) – Total number of lines to have per sample in the training data.</p></li>
<li><p><strong>line_stats_train</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Statistics for sampling from the <code class="docutils literal notranslate"><span class="pre">size</span> <span class="pre">x</span> <span class="pre">dims</span></code> elements for the
training data.</p></li>
<li><p><strong>n_samples_val</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of samples to return in the validation data.</p></li>
<li><p><strong>n_lines_val</strong> (<em>int</em><em>, </em><em>optional</em>) – Total number of lines to have per sample in the validation data.</p></li>
<li><p><strong>line_stats_val</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Statistics for sampling from the <code class="docutils literal notranslate"><span class="pre">size</span> <span class="pre">x</span> <span class="pre">dims</span></code> elements for the
validation data.</p></li>
<li><p><strong>n_samples_test</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of samples to return in the testing data.</p></li>
<li><p><strong>n_lines_test</strong> (<em>int</em><em>, </em><em>optional</em>) – Total number of lines to have per sample in the testing data.</p></li>
<li><p><strong>line_stats_test</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Statistics for sampling from the <code class="docutils literal notranslate"><span class="pre">size</span> <span class="pre">x</span> <span class="pre">dims</span></code> elements for the
testing data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>train_data</strong> (<em>tuple, (X, y)</em>) – Training data with <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p></li>
<li><p><strong>val_data</strong> (<em>tuple, (X, y)</em>) – Validation data with <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p></li>
<li><p><strong>test_data</strong> (<em>tuple, (X, y)</em>) – Testing data with <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="leabratf.tasks.combinatorics.make_datasets.generate_iters_inits_and_handle">
<code class="descclassname">leabratf.tasks.combinatorics.make_datasets.</code><code class="descname">generate_iters_inits_and_handle</code><span class="sig-paren">(</span><em>tf_datasets</em>, <em>init_ops=None</em><span class="sig-paren">)</span><a class="headerlink" href="#leabratf.tasks.combinatorics.make_datasets.generate_iters_inits_and_handle" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the iterators, initializers, and string handler for a list of
<a href="#id1"><span class="problematic" id="id2">``</span></a>tf.Dataset``s.</p>
<p>In order to allow for switching between different <code class="docutils literal notranslate"><span class="pre">tf.Dataset</span></code>, create a
string handler tensor that will swap out what values are in the <code class="docutils literal notranslate"><span class="pre">x</span></code> and
<code class="docutils literal notranslate"><span class="pre">y</span></code> tensors.</p>
<p>To change between datasets, get the string handle returned by the
<code class="docutils literal notranslate"><span class="pre">string_handle()</span></code> method of each iterator, and then pass it into the
placeholder tensor, <code class="docutils literal notranslate"><span class="pre">handle</span></code>, through the feed dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tf_datasets</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">tf.Datasets</span></code> to get the relevant iterators and initializers
for.</p></li>
<li><p><strong>init_ops</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – List of initial operations to perform. Will have initializer operations
added to it.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>x</strong> (<em>tf.Tensor</em>) – Tensor that will contain each of the samples. Actual values will depend
on the value of the string handler.</p></li>
<li><p><strong>y</strong> (<em>tf.Tensor</em>) – Tensor that will contain each of the labels. Actual values will depend
on the value of the string handler.</p></li>
<li><p><strong>iterators</strong> (<em>list</em>) – List of dataset iterators that will be used to get the string handles.</p></li>
<li><p><strong>handle</strong> (<em>tf.Tensor</em>) – String handler that will determine which dataset to load data from.</p></li>
<li><p><strong>init_ops</strong> (<em>list</em>) – List of operations to run at the start of a <code class="docutils literal notranslate"><span class="pre">tf.Session</span></code> with
initializers for each iterator.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="leabratf.tasks.combinatorics.make_datasets.generate_combigen_tf_datasets">
<code class="descclassname">leabratf.tasks.combinatorics.make_datasets.</code><code class="descname">generate_combigen_tf_datasets</code><span class="sig-paren">(</span><em>batch_size_train=1</em>, <em>batch_size_val=50</em>, <em>batch_size_test=500</em>, <em>init_ops=None</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#leabratf.tasks.combinatorics.make_datasets.generate_combigen_tf_datasets" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the combigen <a href="#id3"><span class="problematic" id="id4">``</span></a>tf.Dataset``s necessary to run with tensorflow.</p>
<p>Creates all the tensorflow nodes to properly set up the data pipeline, and
returns the necessary variables. First generate the numpy arrays of the
data, then convert them to <a href="#id5"><span class="problematic" id="id6">``</span></a>tf.Dataset``s with the specified batch size.</p>
<p>Then get the iterators, initializers, and string handler, so it can be
properly iterated through.</p>
<p>Any extra arguments passed will be sent to <code class="docutils literal notranslate"><span class="pre">generate_combigen_datasets</span></code>,
so see its documentation for more detail.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size_train</strong> (<em>int</em><em>, </em><em>optional</em>) – Batch size to use for the training datasets.</p></li>
<li><p><strong>batch_size_val</strong> (<em>int</em><em>, </em><em>optional</em>) – Batch size to use for the validation datasets.</p></li>
<li><p><strong>batch_size_test</strong> (<em>int</em><em>, </em><em>optional</em>) – Batch size to use for the testing datasets.</p></li>
<li><p><strong>init_ops</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – List of operations to run at the start of a <code class="docutils literal notranslate"><span class="pre">tf.Session</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>combigen_tf_parameters</strong> – Tuple of the relevant components for the combigen task. See
<code class="docutils literal notranslate"><span class="pre">generate_iters_inits_and_handle</span></code> for more detail.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple, (x, y, iterators, handle, init_ops)</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="visualization.html" class="btn btn-neutral float-right" title="Visualization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="release_schedule.html" class="btn btn-neutral float-left" title="Release Schedule" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>